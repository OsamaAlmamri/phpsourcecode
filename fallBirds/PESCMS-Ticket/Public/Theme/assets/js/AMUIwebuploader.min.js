$(function(){$.webuploaderConfig=function(t){$.webuploader_for_amazeui=function(e){var r={compress:!1,fileVal:"upfile",auto:!0,duplicate:!0,server:t.server,swf:"Uploader.swf",gallery:!1,thumb:{type:""}};$.extend(r,e);var a,i=window.devicePixelRatio||1,l=100*i,m=100*i;a=WebUploader.create(r),$(".am-btn").on("click",function(){a.upload()}),a.on("fileQueued",function(t){a.makeThumb(t,function(e,a){if(e)var i='<div class="am-gallery-item webuploader-item am-img-thumbnail am-radius"><a href="javascript:;" class="file-preview-other" ><i class="am-icon-file-o am-icon-lg am-block"></i><h3 class="am-gallery-title am-text-center am-hide"></h3></a><div class="am-text-truncate am-text-xs file-preview-other-text am-text-center" >'+t.name+"</div> </div>";else i='<div class="am-gallery-item webuploader-item am-img-thumbnail am-radius"><a href="javascript:;" ><img src="'+a+'"  alt="点击上传图片"/><h3 class="am-gallery-title am-text-center am-hide"></h3></a></div>';var l='<li id="'+t.id+'">'+i+"</li>";1==r.pick.multiple||$("#before"+r.id).prevAll().remove(),$("#before"+r.id).before(l)},l,m)}),a.on("uploadProgress",function(e,a){$.AMUI.progress.start(a)}),a.on("uploadSuccess",function(e,a){if("SUCCESS"==a.state){switch(a.action){case"uploadfile":var i="[url="+a.url+"]"+a.original+"[/url]";break;case"uploadimage":default:i=a.url}$("#"+e.id).append('<input type="hidden" name="'+r.name+'" value="'+i+'" autocomplete="off" >')}$("#"+e.id+" h3.am-gallery-title").html(a.state).removeClass("am-hide")}),a.on("uploadError",function(e,a){$("#"+e.id+" h3.am-gallery-title").html("上传失败").removeClass("am-hide")}),a.on("uploadComplete",function(e){$.AMUI.progress.done()})},$("[data-am-webuploader-simple]").each(function(){var l=AMUI.utils.parseOptions($(this).attr("data-am-webuploader-simple"));if($(this).html(AMUIwebuploader.template(l)),l.content){$("#before"+l.id).prevAll().remove();var e=l.content.replace(/base64,/g,"{base64}");$.each(e.split(","),function(e,a){var i=a.replace(/\{base64\}/g,"base64,");AMUIwebuploader.append({id:l.id,src:i,name:l.name,type:l.type})})}$.webuploader_for_amazeui(l)}),$(document).on("click","[data-am-webuploader-simple] li",function(){$(this).attr("id").match("before")||$(this).remove()})}});var AMUIwebuploader={template:function(e){var a="file"==e.type?"upload_file_icon":"";return'<ul class="am-gallery am-avg-lg am-gallery-overlay am-webuploader-ul" ><li id="before'+e.id+'"><div class="am-gallery-item webuploader-item am-img-thumbnail am-radius webuploader-background-img"><a href="javascript:;" id="'+e.id+'" class="'+a+'"></a></div></li></ul>'},append:function(e){if("file"==e.type)var a='<a href="javascript:;" class="file-preview-other" title="'+e.src+'"   ><i class="am-icon-file-o am-icon-lg am-block"></i><h3 class="am-gallery-title am-text-center am-hide"></h3></a><div class="am-text-truncate am-text-xs file-preview-other-text am-text-center" >'+e.src+"</div>";else a='<a href="javascript:;" ><img src="'+e.src+'"  alt="点击上传图片"/><h3 class="am-gallery-title am-text-center am-hide"></h3></a>';$li='<div class="am-gallery-item webuploader-item am-img-thumbnail am-radius">'+a+"</div>",$li+='<input type="hidden" name="'+e.name+'" value="'+e.src+'" autocomplete="off">',$("#before"+e.id).before('<li id="'+Math.random()+'">'+$li+"</li>")},init:function(e,a){$("#"+e).html(this.template(a)),$.webuploader_for_amazeui(a)}};