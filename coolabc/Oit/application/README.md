// *****************web后台框架******************
// 如果重装系统,oschina 项目地址要使用了ssh方式，并且要创建公钥
https://blog.csdn.net/u012852597/article/details/78822252

// cache缓存的使用,默认文件方式，保存所有用户共同使用的系统公共的参数，此类参数不会过期，
// 有更改的时候，刷新文件
// 公用的资料有 各类数据，数据字典，需要用到时刷新
// * 比如产品资料，系统查询出来，缓存成文件，当A修改了产品资料，那么更新缓存文件
// * 而B获取时，如果不是最新的，那么点击刷新获取最新的缓存资料
// 这样可以减少服务器数据库压力，但是要思考oit系统中更新字典，web框架如何知道
// 可以设置一个缓存文件统一的失效时间

// session的使用
// session存在web服务器统一管理的文件夹中[非tp框架目录]，一旦到了设置的过期时间，就会另外生成一个session文件
// session的过期时间默认是1440秒, 24分钟

// 网络上文件讲失效时间是从session文件最后的修改时间计算，但是测试发现win系统是根据新建时间计算
// 上面这种现象不知道是win系统原因，还是tp

// 登陆的时候，清除原有session,cookie，重新生成session文件，计算失效时间
// session失效时间为24小时，常用的操作检查是否有session信息，没有说明没有登陆;
// 如果页面30分钟不操作，则需要重新登陆，使用cookie设置成30分钟失效，每次操作时都重置cookie的时间

// cookie的失效，其实可以放在客户端中使用js判断，在每次ajax操作的时候首先进行cookie的检查，
//   如果失效，就提示，并且将页面跳转到首页上，可以在cookie中加个last_time，每次操作时更新它的值，就会更新有效时间

// cookie的使用
// cookie是在客户端中保存的小信息,将过期操作参数保存在cookie中，如果接收的时候，没有过期时间的cookie,那么要求重新登陆
// 如果接收到cookie过期时间，尚未过期的，重新设置cookie中的过期时间

// 最新数据
// 其他的信息都直接sql查询获取


// ****************企业微信*********************
企业微信一般手机端使用，静默登录，企业微信通讯录里的资料一般很少改动，session直接24小时失效一次，重新生成


// -------------------------------------
common\controller\OitBase.php
// 控制器基础类，对外公开访问的控制器都继承这个类，有界面的公共的访问方法入口

common\logic\MupLogic.php
// 单个模块的公共的逻辑事件（逻辑层）

common\api\Para.php
// 按功能建立api（各种功能的服务层）


// -------------------------------------
// 控制器
// 根据导航分组定义 控制器与视图
// 单独功能的控制器类，有单独的界面或只返回json数据
emp_app\controller\EmpGuiAdm.php

// 视图
// pc 或 mobile 上，不同的功能，可能会有不同的视图类型需求
emp_app\view\[pc, mobile]\[emp, user]\emp_gui_adm\index

// 模型类[数据表]
// 单独的模型类，如果有需要写入数据，自动完成，自检，都写在此类文件中

// 模型类中定义视图方法，查询以本模型为主的相关数据
// 比如: 主表是emp, 查询员工的备注明细内容 emp_note

// 单独要查询一个数据表中的内容，使用模型查询
// 视图查询多个表中的内容，使用Db::view
// 写入时都使用模型写入，有利于数据检查

// -------------------------------------


优先顺序
1. 逻辑清晰
2. 抽取共同性,减少代码量

设计原则
0. 控制器向视图层传递2种数据，第一种是php数据，页面中使用tp标签或方法获取内容，这种数据或结构一般不会重复使用
   另一种就是json数据
1. 服务端只输出数据 默认json格式，客户端如有需要，再使用js在这基础上调整
2. 客户端-浏览器接收之后，再使用 js 对象处理数据
3. 模块、控制器 按 默认分组(模块)->功能入口设计(控制器),控制器上尽量精简，公共的逻辑封闭在相应逻辑功能中
   控制器中也有必不可少的业务逻辑
4. application/common/logic，分组公共逻辑
5. application/api/*，功能操作方法
6. [待规范]创建一个可访问的 公共操作模块,例如，选择员工、客户、供应商、各种公共字典，能返回界面


页面编写
虽然tp带了一些页面标签比如volist，直接可以在页面嵌入一些语法逻辑，但是只适合解决一些不常见的临时单独实现的功能。
因为不太方便重复调用，比如说顶部菜单按钮，根据 权限生成的，可以直接页面中使用volist创建菜单按钮。
但是如果在另一个需要根据配置创建菜单按钮的时候，就又需要重复使用这个方法，不能直接调用。
所以需要重复调用的，一律使用js创建html


视图层的逻辑
1 控制器index操作,展示页面，并传递页面控件的初始构建：
  1 顶部按钮组
  2 功能下拉菜单
  3 左侧树下拉菜单
  4 各个表格的显示定制列

2 当各个控件都初始化完毕之后,调用页面的显示完成事件,并执行刷新动作
  刷新动作向控制器refresh操作,将控件的data数据，传递至页面，页面将数据赋给各组件
     注意各组件数据的关联性和先后顺序

3 上级页面与下级页面之间的关联，上级页面调用下级页面时，传递当前 模块、控制器、动作给下级页面


模型中的要点
1 关于新增 如果模型定义中含有 $pk,那么在一个实例中保存或批量保存的时候，
  数据中含主键的值，那么第二次会是更新语句,如果模型中不含主键，那么将是新增语句

