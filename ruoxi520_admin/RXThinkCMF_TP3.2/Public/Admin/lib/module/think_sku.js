!function(t){var e={};function i(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}({6:function(t,e,i){i(7)},7:function(t,e){layui.define(["jquery","form"],function(t){"use strict";var e=layui.jquery,i=layui.form,a={c:{sv:"",iv:"",tv:"",item:[],itemed:[],data:[],tableTitleId:[],tableTitle:[],tableTd:[]},z:function(t,e,i){for(var a=0;a<i.length;a++)if(t+"_"+e==i[a])return"checked";return""},y:function(t,e,i,a){for(var n=0;n<e.length;n++)a+='<input type="checkbox" data-id="'+t+"_"+e[n].id+'" title="'+e[n].name+'" lay-skin="primary" lay-filter="item"'+this.z(t,e[n].id,i)+">";return a},x:function(t,e,i){return'<div class="layui-form-item" pane><label class="layui-form-label">'+t.name+'：</label><div class="layui-input-block" data-id="'+t.id+'">'+this.y(t.id,t.sub,e,"")+"</div></div>"},w:function(t,e,i){for(var a=0;a<t.length;a++)i+=this.x(t[a],e,"");return i},st:function(){return'<table class="layui-table" lay-skin="" style="margin:0"><thead>'+this.sth()+"</thead><tbody>"+this.stb()+this.stf()+"</tbody></table>"},sth:function(){for(var t="<tr>",e=0;e<this.c.tableTitle.length;e++)t+='<th style="text-align:center;">'+this.c.tableTitle[e]+"</th>";return t+='<th style="text-align:center;">价格</th><th style="text-align:center;">库存</th><th style="text-align:center;">货号</th><th style="text-align:center;">默认SKU</th><th style="text-align:center;">SKU图集</th></tr>'},stb:function(){for(var t=this,e="",i=[],a=0;a<t.c.data.length;a++){e+="<tr>";for(var n=0;n<t.c.data[a].ids.length;n++){var r="";for(var s in t.c.data[a].ids[n])r=s,t.c.data[a].ids[n][s];(!i[r]||i[r]<1)&&(i[r]=this.ai(t.c.data[a].ids[n][s],this.c.tableTd),i[r]>0&&(e+='<td rowspan="'+i[r]+'" style="text-align:center;">',e+=this.gin(s,t.c.data[a].ids[n][s]),e+="</td>")),i[r]--}e+='<td><input class="layui-input layui-table-input" data-index="'+a+'" data-type="price" lay-filter="input"  value="'+t.c.data[a].price+'" ></td>',e+='<td><input class="layui-input layui-table-input" data-index="'+a+'" data-type="stock" lay-filter="input" value="'+t.c.data[a].stock+'" ></td>',e+='<td><input class="layui-input layui-table-input" data-index="'+a+'" data-type="sku" lay-filter="input" value="'+t.c.data[a].sku+'" ></td>',e+='<td><input name="sex" data-index="'+a+'" data-type="is_default" value="'+t.c.data[a].sku+'" title="默认SKU" checked="" type="radio"></td>',e+='<td style="text-align:center;"><button type="button" class="layui-btn" onclick="uploadImgs('+t.c.data[a].id+');"><i class="layui-icon">&#xe67c;</i>上传图片</button></td>',e+="</tr>"}return e},stf:function(){return this.c.data.length<2?"":'<tr><th colspan="'+this.c.tableTitle.length+'" style="text-align: center">批量修改</th><th><input type="text" class="layui-input layui-table-input" lay-filter="input" data-type="sku-price" /></th><th><input type="text" class="layui-input layui-table-input" lay-filter="input" data-type="sku-stock" /></th><th><input type="text" class="layui-input layui-table-input" lay-filter="input" data-type="sku-sku" /></th></tr>'},gin:function(t,e){for(var i=0;i<this.c.item.length;i++)if(t==this.c.item[i].id)for(var a=0;a<this.c.item[i].sub.length;a++)if(this.c.item[i].sub[a].id==e)return this.c.item[i].sub[a].name;return""},ai:function(t,e){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++)if(t==e[i][a]){for(var n=1,r=i+1;r<e.length;r++)n*=e[r].length;return n}return 0},inArray:function(t,e){if(t&&e&&e.length>0)for(var i=0;i<e.length;i++)if(t==e[i])return!0;return!1},citd:function(t,e){!e||this.inArray(t,this.c.itemed)?!e&&this.c.itemed.indexOf(t)>-1&&this.c.itemed.splice(this.c.itemed.indexOf(t),1):this.c.itemed.push(t)},cd:function(){var t=this.c.itemed,e=this.c.tableTitleId,i=[];if(!(t.length<1)){for(var a=0;a<e.length;a++)for(var n=0;n<t.length;n++){var r=t[n].split("_");r[0]==e[a]&&(i[a]||(i[a]=[]),i[a].push(r[1]))}this.c.tableTd=i;var s=[[]];for(a=0;a<i.length;a++){for(var l=[],c=0;c<s.length;c++)for(var u=0;u<i[a].length;u++)l.push(s[c].concat(i[a][u]));s=l}var d=[];for(a=0;a<s.length;a++){l={ids:[]};for(var o=0;o<s[a].length;o++){var h={};h[e[o]]=s[a][o],l.ids.push(h)}var f=this.ced(l.ids);l.id=f.id,l.price=f.price,l.stock=f.stock,l.sku=f.sku,l.is_default=f.is_default,d.push(l)}this.c.data=JSON.parse(JSON.stringify(d))}},ced:function(t){var e=[];e.price=0,e.stock=0,e.sku=0;for(var i=[],a=0;a<t.length;a++)for(var n in t[a])i.push(n+"_"+t[a][n]);var r=[];for(a=0;a<this.c.data.length;a++){r[a]=[],t=this.c.data[a].ids;for(var s=0;s<t.length;s++)for(var n in t[s])r[a].push(n+"_"+t[s][n]);var l=!0;for(s=0;s<i.length;s++)this.inArray(i[s],r[a])?l*=!0:l*=!1;if(l)return e.id=parseFloat(this.c.data[a].id),e.price=parseFloat(this.c.data[a].price),e.stock=parseInt(this.c.data[a].stock),e.sku=this.c.data[a].sku,e}return e},sod:function(){this.c.itemed.sort(function(t,e){var i=t.split("_"),a=e.split("_");return parseInt(i[0])<parseInt(a[0])?-1:parseInt(i[0])>parseInt(a[0])?1:parseInt(i[1])<parseInt(a[1])?-1:parseInt(i[1])>parseInt(a[1])?1:0})},stt:function(t,e){var i=this;t=i.c.item,e=i.c.itemed;i.c.tableTitleId=[],i.c.tableTitle=[];for(var a=0;a<t.length;a++)for(var n=0;n<t[a].sub.length;n++)i.inArray(t[a].id+"_"+t[a].sub[n].id,e)&&!i.inArray(t[a].id,i.c.tableTitleId)&&(i.c.tableTitle.push(t[a].name),i.c.tableTitleId.push(t[a].id))},listenInput:function(){var t=this;e("input[lay-filter]").on("change",function(i){var a=e(this).val(),n=e(this).attr("data-type"),r=e(this).attr("data-index");if("sku"==n&&t.c.data[r]&&(t.c.data[r].sku=a),"price"==n&&t.c.data[r]&&(t.c.data[r].price=isNaN(parseFloat(a))?0:parseFloat(a)),"stock"==n&&t.c.data[r]&&(t.c.data[r].stock=isNaN(parseInt(a))?0:parseInt(a)),"sku-sku"==n)for(var s=0;s<t.c.data.length;s++)t.c.data[s].sku=a+(s+1);if("sku-price"==n)for(s=0;s<t.c.data.length;s++)t.c.data[s].price=isNaN(parseFloat(a))?0:parseFloat(a);if("sku-stock"==n)for(s=0;s<t.c.data.length;s++)t.c.data[s].stock=isNaN(parseInt(a))?0:parseInt(a);t.rl()})},listen:function(){var t=this;i.on("checkbox(item)",function(i){var a=e(i.elem).attr("data-id");t.citd(a,i.elem.checked),t.sod(),t.stt(),t.cd(),t.rl()}),this.listenInput()},getItem:function(){return this.c.item},getData:function(){return this.c.data},si:function(t){for(var e=0;e<t.length;e++)if(t[e].ids)for(var i=0;i<t[e].ids.length;i++)for(var a in t[e].ids[i])this.inArray(a+"_"+t[e].ids[i][a],this.c.itemed)||this.c.itemed.push(a+"_"+t[e].ids[i][a])},f:function(t){var e=(new Date).getTime(),i=this;i.c.sv=t.id?t.id:"sku",i.c.iv=t.itemelem?t.itemelem:"item-"+e,i.c.tv=t.tableelem?t.tableelem:"table-"+e,i.c.item=t.item?t.item:[],i.c.data=t.data?JSON.parse(JSON.stringify(t.data)):[],i.c.itemed=[],i.c.data&&(i.si(i.c.data),i.sod(),i.stt(),i.cd())},rl:function(){e("#"+this.c.tv).html(this.st()),this.listenInput()},l:function(){e("#"+this.c.sv).append('<div id="'+this.c.iv+'">'+this.w(this.c.item,this.c.itemed,"")+"</div>"),e("#"+this.c.sv).append('<div class="layui-form-item" pane><label class="layui-form-label">商品SKU：</label><div class="layui-input-block" id="'+this.c.tv+'">'+this.st()+"</div></div></div>"),i.render("checkbox"),this.listen()},init:function(t){return this.f(t),this.l(),a},v:"1.0.0"};t("sku",a)})}});