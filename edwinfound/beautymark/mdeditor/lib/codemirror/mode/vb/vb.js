(function(d){"object"==typeof exports&&"object"==typeof module?d(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],d):d(CodeMirror)})(function(d){d.defineMode("vb",function(d,l){function e(a){return new RegExp("^(("+a.join(")|(")+"))\\b","i")}function f(a,b){if(a.eatSpace())return null;if("'"===a.peek())return a.skipToEnd(),"comment";if(a.match(/^((&H)|(&O))?[0-9\.a-f]/i,!1)){var c=!1;a.match(/^\d*\.\d+F?/i)?c=!0:a.match(/^\d+\.\d*F?/)?c=!0:a.match(/^\.\d+F?/)&&
(c=!0);if(c)return a.eat(/J/i),"number";c=!1;a.match(/^&H[0-9a-f]+/i)?c=!0:a.match(/^&O[0-7]+/i)?c=!0:a.match(/^[1-9]\d*F?/)?(a.eat(/J/i),c=!0):a.match(/^0(?![\dx])/i)&&(c=!0);if(c)return a.eat(/L/i),"number"}if(a.match('"'))return b.tokenize=m(a.current()),b.tokenize(a,b);if(a.match(n)||a.match(p))return null;if(a.match(q)||a.match(r)||a.match(t))return"operator";if(a.match(u))return null;if(a.match(v))return b.currentIndent++,b.doInCurrentLine=!0,"keyword";if(a.match(w))return b.doInCurrentLine?
b.doInCurrentLine=!1:b.currentIndent++,"keyword";if(a.match(g))return"keyword";if(a.match(h))return b.currentIndent--,b.currentIndent--,"keyword";if(a.match(k))return b.currentIndent--,"keyword";if(a.match(x)||a.match(y))return"keyword";if(a.match(z))return"variable";a.next();return"error"}function m(a){var b=1==a.length;return function(c,d){for(;!c.eol();){c.eatWhile(/[^'"]/);if(c.match(a))return d.tokenize=f,"string";c.eat(/['"]/)}if(b){if(l.singleLineStringErrors)return"error";d.tokenize=f}return"string"}}
var r=/^[\+\-\*/%&\\|\^~<>!]/,u=/^[\(\)\[\]\{\}@,:`=;\.]/,q=/^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(\/\/)|(\*\*))/,p=/^((\+=)|(\-=)|(\*=)|(%=)|(\/=)|(&=)|(\|=)|(\^=))/,n=/^((\/\/=)|(>>=)|(<<=)|(\*\*=))/,z=/^[_A-Za-z][_A-Za-z0-9]*/,t=e(["and","or","not","xor","in"]),y=e("as dim break continue optional then until goto byval byref new handles property return const private protected friend public shared static true false".split(" ")),x=e("integer string double decimal boolean short char float single".split(" ")),
w=e("class module sub enum select while if function get set property try".split(" ")),g=e(["else","elseif","case","catch"]),k=e(["next","loop"]),h=e(["end"]),v=e(["do"]);return{electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:f,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:!1}},token:function(a,b){a.sol()&&(b.currentIndent+=b.nextLineIndent,b.nextLineIndent=0,b.doInCurrentLine=0);var c;c=b.tokenize(a,b);var d=a.current();if("."===d)c=b.tokenize(a,b),a.current(),
c="variable"===c?"variable":"error";else{var e="[({".indexOf(d);-1!==e&&b.currentIndent++;e="])}".indexOf(d);-1!==e&&b.currentIndent--}b.lastToken={style:c,content:a.current()};return c},indent:function(a,b){var c=b.replace(/^\s+|\s+$/g,"");return c.match(k)||c.match(h)||c.match(g)?d.indentUnit*(a.currentIndent-1):0>a.currentIndent?0:a.currentIndent*d.indentUnit}}});d.defineMIME("text/x-vb","vb")});