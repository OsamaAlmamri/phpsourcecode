(function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})(function(e){function g(a,c,b,d){this.cm=a;this.node=c;this.options=b;this.height=d;this.cleared=!1}function h(a){var c=a.getWrapperElement(),b=window.getComputedStyle?window.getComputedStyle(c):c.currentStyle,d=parseInt(b.height),f=a.state.panels={setHeight:c.style.height,heightLeft:d,panels:0,wrapper:document.createElement("div")};
c.parentNode.insertBefore(f.wrapper,c);b=a.hasFocus();f.wrapper.appendChild(c);b&&a.focus();a._setSize=a.setSize;null!=d&&(a.setSize=function(c,b){if(null==b)return this._setSize(c,b);f.setHeight=b;if("number"!=typeof b){var e=/^(\d+\.?\d*)px$/.exec(b);e?b=Number(e[1]):(f.wrapper.style.height=b,b=f.wrapper.offsetHeight,f.wrapper.style.height="")}a._setSize(c,f.heightLeft+=b-d);d=b})}e.defineExtension("addPanel",function(a,c){this.state.panels||h(this);var b=this.state.panels;c&&"bottom"==c.position?
b.wrapper.appendChild(a):b.wrapper.insertBefore(a,b.wrapper.firstChild);var d=c&&c.height||a.offsetHeight;this._setSize(null,b.heightLeft-=d);b.panels++;return new g(this,a,c,d)});g.prototype.clear=function(){if(!this.cleared){this.cleared=!0;var a=this.cm.state.panels;this.cm._setSize(null,a.heightLeft+=this.height);a.wrapper.removeChild(this.node);if(0==--a.panels){var a=this.cm,c=a.state.panels;a.state.panels=null;var b=a.getWrapperElement();c.wrapper.parentNode.replaceChild(b,c.wrapper);b.style.height=
c.setHeight;a.setSize=a._setSize;a.setSize()}}};g.prototype.changed=function(a){a=null==a?this.node.offsetHeight:a;this.cm._setSize(null,this.cm.state.panels.height+=a-this.height);this.height=a}});