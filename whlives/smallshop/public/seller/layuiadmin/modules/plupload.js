/** layuiAdmin.std-v1.2.1 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(function(a){var e,i=layui.admin,t=layui.jquery;obj={set_callback_obj:function(a){e=a},upload:function(){var a,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"100",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;i.req({url:layui.setter.apiHost+"/helper/aliyun_token",data:{model:l},success:function(i){if(0==i.code){a=i.data;var l=new Array;t(".plupload_btn").each(function(){l.push(t(this).attr("id"))});var r="";t(".plupload_btn").on("click",function(){r=t(this).attr("id")});var u="",c="",o=new plupload.Uploader({browse_button:l,url:a.host,chunk_size:"0",unique_names:!0,flash_swf_url:"../lib/plupload/Moxie.swf",silverlight_xap_url:"../lib/plupload/Moxie.xap",filters:{max_file_size:s+"mb",mime_types:[{title:"Image files",extensions:"jpg,gif,png,jpeg"}],prevent_duplicates:!0},resize:{quality:n,preserve_headers:!1},init:{FilesAdded:function(a,i){var l=!0;if(t("#"+r).hasClass("is_callback")){l=!1;try{fun_name=r,t("#"+r).attr("callback_fun")&&(fun_name=t("#"+r).attr("callback_fun")),e[fun_name].call(this,{id_name:r,file_num:i.length})&&(l=!0)}catch(n){}}l?(c=layer.msg("正在上传，请稍后",{icon:16,shade:.01,time:1e9}),o.start()):t.each(i,function(a,e){o.removeFile(e)})},BeforeUpload:function(e,i){u={key:a.dir+i.target_name,policy:a.policy,OSSAccessKeyId:a.accessid,success_action_status:"200",signature:a.signature},e.setOption({multipart_params:u})},FileUploaded:function(i,l,n){var s=a.domain+a.dir+l.target_name;if(r)if(t("#"+r).hasClass("is_callback"))try{fun_name=r,t("#"+r).attr("callback_fun")&&(fun_name=t("#"+r).attr("callback_fun")),e[fun_name].call(this,{id_name:r,url:s})}catch(u){}else t("#"+r).parent().find("img").attr("src",s).removeClass("layui-hide"),t("#"+r).parent().find("a").attr("href",s),t("#"+r).parent().find('[type="hidden"]').val(s)},UploadComplete:function(a,e){layer.close(c)},UploadProgress:function(a,e){},Error:function(a,e){e.message?layer.msg(e.message):layer.msg("上传失败")}}});o.init()}}})}},a("plupload",obj)});