/** layuiAdmin.std-v1.2.1 LPPL License By http://www.layui.com/admin/ */
 ;"use strict";layui.define(["table"],function(e){var t=layui.$,i=layui.layer,a=layui.view,n=layui.admin,r=layui.table,o=layui.form;r.set({headers:{token:layui.data(layui.setter.tableName).token},where:{token:layui.data(layui.setter.tableName).token},method:"post",defaultToolbar:["filter"],limit:20,limits:[10,30,50],text:"对不起，加载出现异常！"}),o.on("submit(search_button)",function(e){var t=e.field;r.reload("table_list",{where:t,page:{curr:1}})});var l={ajax:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"table_list";if(a||(a={}),!a.id){for(var s=new Array,u=r.checkStatus(l),d=u.data,c=0;c<d.length;c++)s.push(d[c].id);if(!(s.length>0))return i.msg("没有选择任何数据"),!1;a.id=s}var f=!1;if(n.req({url:e,data:a,async:!1,success:function(e){0==e.code?(o&&i.msg("操作成功",{time:1e3},function(){t("#"+l).length>0?r.reload(l):location.reload()}),f=!0):e.msg?i.msg(e.msg):i.msg("操作失败")}}),f)return f},open_iframe:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"100%",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"100%";"100%"==i&&(a="100%"),n.popup({type:2,title:e,area:[i,a],id:(new Date).getTime(),scrollbar:!1,content:t,success:function(e,t){}})},open_window:function(e,l,s){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};"100%"==u.width&&(u.height="100%"),u.width||(u.width="600px"),u.height||(u.height="550px"),u.detail_url||(u.detail_url=l+"/detail"),u.save_url||(u.save_url=l+"/save"),n.popup({title:e,area:[u.width,u.height],id:(new Date).getTime(),success:function(e,l){var c=d;u.id&&u.detail_url&&n.req({url:u.detail_url,data:{id:u.id},async:!1,success:function(e){0==e.code&&(c=t.extend(d,e.data))}}),a(this.id).render(s,c).done(function(){o.render(null,"form"),c&&o.val("form",c),o.on("submit(form-submit)",function(e){n.req({type:"POST",url:u.save_url,data:e.field,success:function(e){0==e.code?i.msg("操作成功",{time:1e3},function(){t("#table_list").length>0?r.reload("table_list"):location.reload(),i.close(l)}):1==e.code?i.alert(e.msg):i.msg(e.msg)},error:function(){i.msg("操作失败，请刷新页面重试！")}})})})}})},editor_create:function(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"content";n.req({url:layui.setter.apiHost+"/helper/aliyun_token",data:{model:"editor"},success:function(a){if(0==a.code){e=a.data;var n=[],r=window.wangEditor,o="editor"+i;n[o]=new r("#editor_"+i),n[o].customConfig.onchange=function(e){t('[name="'+i+'"]').val(filterXSS(e))},n[o].customConfig.uploadImgServer=e.host,n[o].customConfig.uploadFileName="file",n[o].customConfig.uploadImgParams={domain:e.domain,key:e.dir,policy:e.policy,OSSAccessKeyId:e.accessid,success_action_status:"200",signature:e.signature},n[o].create()}}})},image_resize:function(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"lfit",n="";if(e.indexOf("http")==-1||e.indexOf("oss-process")!=-1)return e;var r=Array();return t&&r.push("w_"+t),i&&r.push("h_"+i),a&&r.push("m_"+a),n=e+"?x-oss-process=image/resize,"+r.join(",")},get_area:function(e,a,r){r||(r=0),a||(a=0),e||(e="prov_id"),n.req({url:layui.setter.apiHost+"/helper/area",data:{parent_id:a},async:!1,success:function(i){if(0==i.code){var a='<option value="0"></option>';t.each(i.data,function(e,t){var i="";t.id==r&&(i="selected"),a+='<option value="'+t.id+'" '+i+">"+t.name+"</option>"}),t("#"+e).html(a),"city_id"==e&&t("#area_id").html('<option value=""></option>'),o.render("select")}},error:function(){i.msg("操作失败，请刷新页面重试！")}})},set_default_area:function(e,t,i){this.get_area("prov_id",0,e),e&&e&&(this.get_area("city_id",e,t),t&&i&&this.get_area("area_id",t,i))},get_query_variable:function(e){for(var t=window.location.search.substring(1),i=t.split("&"),a=0;a<i.length;a++){var n=i[a].split("=");if(n[0]==e)return n[1]}return!1}};e("helper",l)});