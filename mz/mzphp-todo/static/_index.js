/*[tplStatic 1.0 - 1609]*/

(function(window,document){function systemInit(list,conf){var tabList=[{index:0,name:'待办',filter:'uncompletedList'},{index:1,name:'已办',filter:'completedList'},{index:2,name:'全部',filter:'allList'}];return new Vue({el:'#todo-page',data:{tabActive:'index',tabIndex:0,tabList:tabList,filterFunc:'',newTodo:'',delTodo:null,todoList:list||[]},methods:{add:function(label){if(!label){return;}
this.todoList.unshift({todo:label,completed:0,dateline:Math.round(new Date().getTime()/1000)});this.newTodo='';},del:function(todo){this.todoList.$remove(todo);this.delTodo=null;},done:function(todo){todo.completed=todo.completed==0?Math.round(new Date().getTime()/1000):0;},tabChange:function(tab){var that=this;this.tabIndex=tab.index;this.filterFunc=function(todo){switch(that.tabIndex){case 0:return todo.completed==0?true:false;case 1:return todo.completed>0?true:false;case 2:return true;}};},todoCount:function(tab){var count=0;var todoList=this.todoList;for(var i in todoList){switch(tab.index){case 0:count+=todoList[i].completed==0?1:0;break;case 1:count+=todoList[i].completed>0?1:0;break;case 2:count+=1;break;}}
return count?""+count:0;}},watch:{todoList:function(val){window.API.post('edit',{data:JSON.stringify(this.todoList)},function(data){if(!data||data.error>0){console.log('SaveToDoError',data);}else{console.log('SaveToDoSuccess',data);}});}},created:function(){this.tabChange(tabList[0]);}});}
window.API.get('list',function(data){systemInit(data.extend.list,data.extend.conf);});})(window,document);;
