"use strict";$(function(){function a(o){if(o&&""!=o){var t=$('[data-role="delete-cart"]').data("url");o=o.split(","),$.post(t,{ids:o},function(t){if(1==t.code){toast.success(t.msg,"温馨提示"),$.muushop.get_cart_count();for(var a=0;a<o.length;a++)$('.good-section[data-id="'+o[a]+'"]').fadeOut(500,function(){if($(this).remove(),i(),$(".good-section").length<=0){$(".cart-main").html('<div class="empty-cart-item"><p class="empty-cart-p tips-font">购物车还是空的噢<br><a href="/muushop/index/cats.html">去挑几件商品吧!</a></p></div>')}})}else toast.error(t.msg,"温馨提示")})}else toast.error("请先选择要移除的商品","温馨提示")}function n(t){var a=parseFloat(t.find(".count-input").val()),o=parseFloat(t.parents(".good-section").find(".good-section-tprice span").text());t.parents(".good-section").find(".good-section-tsum span").html(function(t){t=t.toString().replace(/\$|\,/g,""),isNaN(t)&&(t="0");var a=t==(t=Math.abs(t)),o=(t=Math.floor(100*t+.50000000001))%100;t=Math.floor(t/100).toString(),o<10&&(o="0"+o);return(a?"":"-")+t+"."+o}(a*o)),t.parents(".good-section").hasClass("checked-section")&&i()}function i(){var a=0,t=$(".checked-section"),o="";t.each(function(){a+=parseFloat($(this).find(".product-price").text(),10);var t=$(this).data("id");o+=","+t}),o=o.substr(1),$(".buyImmediately").data("id",o),$(".editing-cart").data("id",o),$("#products-price-all").text(a.toFixed(2)),$("#products-count").text(t.length)}$('[data-role="all-check"]').click(function(){for(var t=$(".good-section"),a=0;a<t.length;a++)$(t[a]).toggleClass("checked-section");i()}),$('[data-role="all-check"]:first').click(),$('[data-role="del-cart"]').click(function(){var t=new Array;$(".checked-section").each(function(){t.push($(this).data("id"))}),a(t=t.join(","))}),$('[data-role="delete-cart"]').click(function(t){t.stopPropagation(),a($(this).parents(".good-section").attr("data-id"))}),$('[data-rule="buy-immediately"]').click(function(){var t=$(this).find("#products-count").text(),a=$(this).data("id");if(0<t){var o=$('[data-rule="buy-immediately"]').data("url");window.location.href=o+"?cart_id="+a}else toast.error("请先选择商品","温馨提示")}),$(".count-box .add-btn").click(function(t){var a=$(this).parents(".count-box"),o=a.parents(".good-section-quantity").find(".quantity").text();t.stopPropagation(),e.add(a,o),n(a)}),$(".count-box .cut-btn").click(function(t){var a=$(this).parents(".count-box");t.stopPropagation(),e.cut(a),n(a)}),$(".good-section").click(function(){$(this).toggleClass("checked-section"),i()});var e={add:function(t,a){a=parseInt(a);var o=parseInt(t.find(".count-input").val());a<=o||(t.find(".count-input").val(o+1),c(t.parents(".good-section").attr("data-id"),o+1))},cut:function(t){var a=parseInt(t.find(".count-input").val());a<=1||(t.find(".count-input").val(a-1),c(t.parents(".good-section").attr("data-id"),a-1))}};function c(t,a){var o=$('[data-role="edit-cart"]').data("url"),n={id:t,quantity:a};$.post(o,n,function(t){1==t.code||toast.error(t.info,"温馨提示")})}});