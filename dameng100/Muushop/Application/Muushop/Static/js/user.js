"use strict";$(function(){function a(a,s){var t="Muushop/api/orders/status/"+a;$.get(t,function(a){1==a.status&&$(s).find('[data-toggle="num"]').text(a.data.totalCount)})}a(1,".status-1"),a(2,".status-2"),a(3,".status-3"),a(4,".status-4")}),$(function(){var a;$.get("Muushop/api/result_url",function(s){a=1==s.status?encodeURI(s.data):_ROOT_+"/Muushop/user/orders"});$.get("Muushop/api/orders/status/1,2,3,4",function(s){1==s.status?($(".index-orders-list").empty(),$.each(s.data.list,function(s,t){var e="";switch(t.pay_type){case"onlinepay":e="在线支付";break;case"balance":e="余额支付";break;case"delivery":e="货到付款"}var d="";switch(t.status){case"1":var i=["order_no",t.order_no,"result_url",a],n="待付款";d='<a href="'+U("Muushop/pay/charge",i)+'" class="btn btn-success btn-block" data-toggle="pay_order">立即支付</a><a class="btn btn-warning btn-block" data-toggle="cannel_order" data-id="'+t.id+'">取消订单</a>';break;case"2":n="待发货";"delivery"==t.pay_type&&(d+='<a class="btn btn-warning btn-block" data-toggle="cannel_order" data-id="'+t.id+'">取消订单</a>'),d+='<a class="btn btn-block" data-remote="'+(r=U("Muushop/User/orders",["action","delivery_info","id",t.id]))+'" data-toggle="modal">查看物流</a>';break;case"3":n="已发货";var r=U("Muushop/User/orders",["action","delivery_info","id",t.id]);d='<a class="btn btn-danger btn-block" data-toggle="do_receipt" data-id="'+t.id+'"}>确认收货</a><a class="btn btn-block" data-remote="'+r+'" data-toggle="modal">查看物流</a>';break;case"4":n="待评价";d='<a class="btn  btn-info btn-block" href="'+(r=U("Muushop/User/comment",["id",t.id]))+'">评价</a>';break;default:d=""}var o="";o+='<div class="order-item row clearfix">',o+='<div class="order-base-info clearfix"><span class="pull-left">订单号：'+t.order_no+'</span><span class="order-status pull-right">'+n+"</span></div>",o+='<div class="col-md-9"><div class="goods-box clearfix">';var l="";$.each(t.products,function(a,s){l+='<div class="goods-item clearfix">',l+='<div class="p-img"><a href="/index.php?s=/muushop/index/product/id/'+s.sku_id+'.html" target="_blank"><img src="'+s.main_img+'"></a></div>',l+='<div class="p-msg"><div class="p-name"><a href="/index.php?s=/muushop/index/product/id/12.html" target="_blank">'+s.title+"</a></div>",l+='<div class="sku_box">';var t="";s.sku&&$.each(s.sku,function(a,e){t+='<span class="sku_li_span">'+s.sku[a]+"</span>"}),l+=t,l+="</div>",l+='<div class="goods-number">x'+s.quantity+"</div>",l+="</div>",l+="</div>"}),o+=l,o+="</div></div>",o+='<div class="col-md-3"><div class="row">',o+='<div class="col-md-6 col-xs-12">',o+='<div class="amount text-center">合计：<span>¥'+t.paid_fee+"</span></div>",o+='<div class="paytype text-center"><span>'+e+"</span></div>",o+="</div>",o+='<div class="col-md-6 col-xs-12"><div class="operate">',o+=d,o+="</div></div>",o+="</div></div></div>",o+="</div>",$(".index-orders-list").append(o)})):($(".index-orders-list").empty(),$(".index-orders-list").html('<span class="empty">还没有待处理的订单哦~</span>'))})});