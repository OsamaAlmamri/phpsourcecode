"use strict";$(function(){var a=new Swiper(".view .swiper-container",{prevButton:".swiper-button-prev",nextButton:".swiper-button-next",onInit:function(a){$(".preview .swiper-slide:first").addClass("active-nav")},onSlideChangeStart:function(i){$(".preview .swiper-slide").removeClass("active-nav"),$(".preview .swiper-slide").each(function(){$(this).removeClass("active-nav"),$(this).data("id")==a.activeIndex+1&&$(this).addClass("active-nav")})}}),i=new Swiper(".preview .swiper-container",{visibilityFullFit:!0,slidesPerView:"auto",allowTouchMove:!1,onTap:function(){a.slideTo(i.clickedIndex)}})}),$(function(){var a=$('input[data-toggle="product_sku"]').val();a=$.parseJSON(a),$(".sku-content").Muusku({sku_data:a})}),$(function(){var a=$('input[data-toggle="product_sku"]').val();a=$.parseJSON(a),$(".buyImmediately").click(function(){var i=$('[data-type="title"]').data("id"),t=$(".count-input").val();if(t=isNaN(t)?1:t,a){var e=$(".sku-content").find("input").val();e?window.location.href="index.php?s=/muushop/order/makeorder&id="+i+"&quantity="+t+"&sku="+e:alert("请选择商品规格")}else window.location.href="index.php?s=/muushop/order/makeorder&id="+i+"&quantity="+t})}),$(function(){var a=$('input[data-toggle="product_sku"]').val();a=$.parseJSON(a),$(".addCartNow").click(function(){var i=$(".count-input").val();i=isNaN(i)?1:i;var t=$('[data-type="title"]').data("id");if(a){var e=$(".sku-content").find("input").val();if(!e)return void alert("请选择商品规格");t+=";"+e}var s={sku_id:t,quantity:i},n=$('input[data-toggle="add_cart_url"]').val();$.post(n,s,function(a){1==a.status?($.get_cart_count(),toast.success(a.info,"温馨提示")):toast.error(a.info,"温馨提示")})})}),$(function(){var a=$(".count-content .cut-btn"),i=$(".count-content .add-btn"),t=$(".count-content .count-input");a.click(function(){t.val()<=1||t.val(parseInt(t.val())-1)}),i.click(function(){var a=parseInt($(".quantity span").text());t.val()>=a||t.val(parseInt(t.val())+1)})}),$(function(){function a(a,i){a=a||1,i=i||10;var t=$('[data-toggle="product_id"]').val(),e="/muushop/api/comment/page/"+a+"/r/"+i+"/product_id/"+t;$.get(e,function(t){if(1==t.status){var e=t.data.list;null==e&&(e=""),$("#comment .list-box").html("");for(var s=0;s<e.length;s++){for(var n="",c=0;c<e[s].sku.length;c++)n+='<span class="sku_item">'+e[s].sku[c]+"</span>";if(e[s].images){for(var r="",l=0;l<e[s].images_small_list.length;l++)r+='<span class="img_box"><img src='+e[s].images_small_list[l]+" /></span>";for(var o="",p=0;p<e[s].images_big_list.length;p++)o+='<span class="img_box"><img src='+e[s].images_big_list[p]+" /></span>";var d='<div class="images-item"><div class="small-images clearfix" data-role="images">'+r+'</div><div class="big-images">'+o+"</div></div>"}else d="";var u;u='<div class="comment-item clearfix"><div class="col-xs-2"><div class="user-item"><div class="avatar"><img src="'+e[s].user.avatar32+'" class="img-circle" /></div><div class="nickname">'+e[s].user.nickname+'</div></div></div><div class="col-xs-10"><div class="score clearfix"><div class="atar_Show"><p tip="'+e[s].score+'"></p></div><span></span></div><div class="brief">'+e[s].brief+"</div>"+d+'<div class="sku">'+n+' <span class="create_time">'+e[s].create_time+"</span></div></div></div>",$("#comment .list-box").append(u)}$("#comment .list-box .score p").each(function(a,i){var t=$(this).attr("tip"),e=2*t*16;$(this).css("width",e),$(this).parent(".atar_Show").siblings("span").text(t+"分")}),$("#comment").on("click",".small-images span",function(){$("#comment .small-images span").removeClass("selected"),$(this).addClass("selected"),$(this).parent().parent().find(".big-images span").css("display","none");var a=$(this).index();$(this).parent().parent().find(".big-images span:eq("+a+")").css("display","block")}),$("#comment").on("click",".big-images span",function(){$(this).css("display","none"),$(this).parent().parent().find(".small-images span").removeClass("selected")});var v=t.data.totalCount,m=Math.ceil(v/i);if($("#comment .page-box .now_page").text(a),$("#comment .page-box .pager").html(""),m>1){if(a>1){var g='<li class="previous"><a href="javascript:;">« 上一页</a></li>';$("#comment .page-box .pager").append(g)}if(a>3){var f='<li class="page_num"><a href="javascript:;">1</a></li>';f+="<li><a>...</a></li>",$("#comment .page-box .pager").append(f)}for(s=1;s<=m;s++){var h="";a+3>s&&a-3<s&&(h='<li class="page_num"><a href="javascript:;">'+s+"</a></li>"),a<3&&s<6&&(h='<li class="page_num"><a href="javascript:;">'+s+"</a></li>"),s+1>m&&(h="<li><a>...</a></li>",h+='<li class="page_num"><a href="javascript:;">'+s+"</a></li>"),a==s&&(h='<li class="page_num active"><a href="javascript:;">'+s+"</a></li>"),$("#comment .page-box .pager").append(h)}if(m>a){g='<li class="next"><a href="javascript:;">下一页 »</a></li>';$("#comment .page-box .pager").append(g)}}}})}a(1,10),$(document).on("click",".page-box .pager li.page_num a",function(){return a(parseInt($(this).text())),!1}),$(document).on("click",".page-box .pager li.next a",function(){return a(parseInt($("#comment .page-box .now_page").text())+1),!1}),$(document).on("click",".page-box .pager li.previous a",function(){return a(parseInt($("#comment .page-box .now_page").text())-1),!1})});