$(function(){
    $('#pwd').focus();
});

//修改密码
function account_reset_pwd(){
    var $pwd = $('#pwd');
    var $new_pwd = $('#new_pwd');
    var pwd = $pwd.val();
    var new_pwd = $new_pwd.val();

    if(!simple_validate.required(pwd)){
        layer.msg('请填写原密码');
        $pwd.focus();
        return false;
    }

    if(!simple_validate.range(pwd, 6, 16)){
        layer.msg('原密码长度为6-16位');
        $pwd.focus();
        return false;
    }

    if(!simple_validate.required(new_pwd)){
        layer.msg('请填写新密码');
        $new_pwd.focus();
        return false;
    }

    if(!simple_validate.range(new_pwd, 6, 16)){
        layer.msg('新密码长度为6-16位');
        $new_pwd.focus();
        return false;
    }

    var post_data = {
        pwd: pwd,
        new_pwd: new_pwd
    };
    //Geetest验证码
    var $captcha = $('#captcha');
    if($captcha.length > 0){
        post_data.geetest_challenge = $(':input[name=geetest_challenge]').val();
        post_data.geetest_validate = $(':input[name=geetest_validate]').val();
        post_data.geetest_seccode = $(':input[name=geetest_seccode]').val();
    }

    layer.load();
    $.post(
        '/api/account/reset_pwd',
        post_data,
        function(json){
            layer.closeAll('loading');
            if(json.error_code == 'ok'){
                layer.msg('密码修改成功');
                $pwd.val('').focus();
                $new_pwd.val('');
            }
            else{
                show_error(json.error_code);
            }
        },
        'json'
    );

    return false;
}